<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN:"
"http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="Board">
<resultMap id="resultBoard" type="Board">
	<!-- prop 는 필드명, column 은 DB 컬럼 명 -->
	<id property="boardCodeSeq" column="BOARD_CODE_SEQ"/>
	<result  property="userId" column="USER_ID" />
	<result  property="userPw" column="USER_PW" />
	<result property="boardTitle" column="BOARD_TITLE" />
	<result property="boardContent" column="BOARD_CONTENT" />
	<result property="boardType" column="BOARD_TYPE" />
	<result property="boardDate" column="BOARD_DATE"/>
	<result property="boardCount" column="BOARD_COUNT" />
</resultMap>

<resultMap id="resultBoardThumb" type="BoardThumb">
	<!-- prop 는 필드명, column 은 DB 컬럼 명 -->
	<id property="boardCodeSeq" column="BOARD_CODE_SEQ"/>
	<result property="userId" column="USER_ID" />
	<result property="boardThumb" column="BOARD_THUMB" />
</resultMap>

<!-- 게시글 목록 조회 -->
<select id="selectBoardList" parameterType="BoardPage" resultType="Board" resultMap="resultBoard">
<![CDATA[
	SELECT * FROM (SELECT ROWNUM RNUM, BOARD_CODE_SEQ, USER_ID, USER_PW, BOARD_TITLE,
		BOARD_CONTENT, BOARD_TYPE, BOARD_DATE, BOARD_COUNT
		FROM (SELECT * FROM BOARD ORDER BY BOARD_CODE_SEQ DESC))
		WHERE RNUM >= #{startPage} AND RNUM <= #{endPage}
]]>
</select>

<!-- 게시글 전체 글 개수 조회 -->
<select id="boardListCount" resultType="_int">
	SELECT COUNT(*) cnt FROM BOARD
</select>

<!-- 게시글 추천 조회 -->
<select id="selectBoardThumb" parameterType="int" resultType="BoardThumb" resultMap="resultBoardThumb">
	SELECT * FROM BOARD_THUMB_COUNT WHERE BOARD_CODE_SEQ = #{boardCodeSeq}
</select>

<!-- 게시글 상세 조회 -->
<select id="selectBoardOne" parameterType="int" resultType="Board" resultMap="resultBoard">
	SELECT * FROM BOARD WHERE BOARD_CODE_SEQ = #{boardCodeSeq}
</select>

<!-- 게시글 등록하기 -->
<insert id="insertBoard"  parameterType="Board">
	INSERT INTO BOARD VALUES(
		BOARD_SEQ.NEXTVAL, 1234, 1234, #{boardTitle}, #{boardContent},
		#{boardType}, SYSDATE, 0)
</insert>

<!-- 게시글 수정하기 -->
<update id="updateBoard" parameterType="Board">
	UPDATE BOARD SET BOARD_TITLE=#{boardTitle}, BOARD_CONTENT=#{boardContent},
		BOARD_TYPE=#{boardType} WHERE BOARD_CODE_SEQ=#{boardCodeSeq}
</update>

<!-- 게시글 삭제하기 -->
<delete id="deleteBoard" parameterType="Board">
	DELETE FROM BOARD WHERE BOARD_CODE_SEQ=#{boardCodeSeq}
</delete>

</mapper>
